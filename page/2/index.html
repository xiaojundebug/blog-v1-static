<!DOCTYPE html><html class="theme-next muse use-motion" lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=6.4.1" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.1"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.1"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.1"><link rel="mask-icon" href="/images/logo.svg?v=6.4.1" color="#222"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"",scheme:"Muse",version:"6.4.1",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:!1,onmobile:!0},fancybox:!1,fastclick:!1,lazyload:!1,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><meta property="og:type" content="website"><meta property="og:title" content="Xiaojun&#39;s Blog"><meta property="og:url" content="https://xiaojun1994.top/page/2/index.html"><meta property="og:site_name" content="Xiaojun&#39;s Blog"><meta property="og:locale" content="en_US"><meta property="article:author" content="xiaojun1994"><meta property="article:tag" content="xiaojun,blog"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://xiaojun1994.top/page/2/"><script type="text/javascript" id="page.configurations">CONFIG.page={sidebar:""}</script><title>Xiaojun's Blog</title><noscript><style type="text/css">.sidebar-inner,.use-motion .brand,.use-motion .collection-title,.use-motion .comments,.use-motion .menu-item,.use-motion .motion-element,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .logo,.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.logo-line-after i{right:initial}</style></noscript><meta name="generator" content="Hexo 5.4.2"></head><body itemscope itemtype="http://schema.org/WebPage" lang="en"><div class="container sidebar-position-left page-home"><div class="headband"></div> <a class="ribbon" href="https://github.com/xiaojun1994" target="_blank"><img style="position:absolute;top:0;right:0;border:0" src="/images/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Xiaojun's Blog</span><span class="logo-line-after"><i></i></span></a></div></div><div class="site-nav-toggle"> <button aria-label="Toggle navigation bar"><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>Archives</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><section id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/5204488b.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/5204488b.html" itemprop="url">ç”¨travis-ciè‡ªåŠ¨åŒ–æ„å»ºéƒ¨ç½²github-pages</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2019-09-04 19:39:33" itemprop="dateCreated datePublished" datetime="2019-09-04T19:39:33+08:00">2019-09-04</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">4.6k</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ€è¿‘é‡æ–°æ£é¼“äº†ä¸€ä¸‹ä»¥å‰å­¦ä¹  react æ‰€å†™çš„ä¸€ä¸ªåå°ç³»ç»Ÿï¼Œç”±äºæœ‰ä¸ªåœ¨çº¿é¢„è§ˆåŠŸèƒ½ä½¿ç”¨äº† Github Pagesï¼Œæ¯æ¬¡ push å‰éƒ½éœ€è¦ build ä¸€ä¸‹ï¼Œå¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥æƒ³æ­å»ºä¸€ä¸ª Jekinsã€GitLab Runnerï¼Œä½†æ˜¯å¥ˆä½• vps ç¡¬ä»¶ä¸ç»™åŠ›ï¼Œç´¢æ€§è¿˜æ˜¯ç”¨äº† Travis CIã€‚</p><h2 id="å…³è”-GitHub-å·¥ç¨‹"><a href="#å…³è”-GitHub-å·¥ç¨‹" class="headerlink" title="å…³è” GitHub å·¥ç¨‹"></a>å…³è” GitHub å·¥ç¨‹</h2><p>ç”¨ github æˆæƒç™»å½• travisï¼Œç„¶åæŠŠä½ æƒ³å…³è”çš„å·¥ç¨‹å¼€å…³æ‰“å¼€ï¼ˆå…è´¹ç‰ˆåªèƒ½ç”¨åœ¨ github å…¬å…±ä»“åº“ä¸­ï¼Œç§æœ‰ä»“åº“ä¸è¡Œï¼‰</p><h2 id="ç¼–å†™-travis-yml"><a href="#ç¼–å†™-travis-yml" class="headerlink" title="ç¼–å†™ .travis.yml"></a>ç¼–å†™ .travis.yml</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># .travis.yml</span></span><br><span class="line"><span class="comment"># see https://docs.travis-ci.com/user/deployment/pages/</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">node_js</span></span><br><span class="line"><span class="attr">node_js:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">10</span></span><br><span class="line"><span class="attr">install:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">yarn</span></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">unset</span> <span class="string">CI</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">yarn</span> <span class="string">build</span></span><br><span class="line"><span class="attr">cache:</span> <span class="string">yarn</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">provider:</span> <span class="string">pages</span></span><br><span class="line">  <span class="attr">local_dir:</span> <span class="string">build</span></span><br><span class="line">  <span class="attr">skip_cleanup:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">keep_history:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">github_token:</span> <span class="string">$GITHUB_TOKEN</span></span><br><span class="line">  <span class="attr">on:</span></span><br><span class="line">    <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p><code>$GITHUB_TOKEN</code> æŒ‡è®¾ç½®é‡Œçš„ <code>Environment Variables</code>ï¼Œå®ƒéœ€è¦ä¸€ä¸ª github personal access tokens<br><img src="https://s2.ax1x.com/2019/09/04/nZGZad.jpg" alt="nZGZad.jpg"></p><p>ä½¿ç”¨ github ç”Ÿæˆ token: æ‰“å¼€ <a target="_blank" rel="noopener" href="https://github.com/settings/tokens">https://github.com/settings/tokens</a> -&gt; Generate new token -&gt; éšä¾¿å¡«ä¸€ä¸ªåå­—ï¼Œå‹¾é€‰ repo å¹¶ä¿å­˜ï¼Œè®°å¥½ tokenï¼Œåªèƒ½çœ‹ä¸€æ¬¡<br><img src="https://s2.ax1x.com/2019/09/04/nZG3qg.jpg" alt="nZG3qg.jpg"></p><h2 id="æ–°å»º-gh-pages-åˆ†æ”¯"><a href="#æ–°å»º-gh-pages-åˆ†æ”¯" class="headerlink" title="æ–°å»º gh-pages åˆ†æ”¯"></a>æ–°å»º gh-pages åˆ†æ”¯</h2><p>ç”±äºå®ƒé»˜è®¤ä¼š push åˆ° <code>gh-pages</code> åˆ†æ”¯ï¼Œåˆ†æ”¯ä¸å­˜åœ¨ä¼šæ„å»ºå¤±è´¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ‰‹åŠ¨æ–°å»ºä¸€ä¸ªè¿™ä¸ªåˆ†æ”¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">git checkout --orphan gh-pages</span><br><span class="line">git <span class="built_in">rm</span> -rf .</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;# new branch&#x27;</span> &gt;&gt; README.md</span><br><span class="line"></span><br><span class="line">git add README.md</span><br><span class="line">git commit -m <span class="string">&#x27;new branch&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="æ£€éªŒ"><a href="#æ£€éªŒ" class="headerlink" title="æ£€éªŒ"></a>æ£€éªŒ</h2><p>push ä¸€ä¸‹ï¼Œç¨ç­‰ç‰‡åˆ»æµè§ˆå™¨ä¸­ä¾¿ä¼šæ‰“å°æ„å»ºä¿¡æ¯</p><p><img src="https://s2.ax1x.com/2019/09/04/nZBbBq.jpg" alt="nZBbBq.jpg"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/f35688ba.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/f35688ba.html" itemprop="url">è®°å½•ä¸€ä¸‹Reactç®€æ˜“åå°ç®¡ç†ç³»ç»Ÿæ­å»ºè¿‡ç¨‹</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2019-09-01 00:18:36" itemprop="dateCreated datePublished" datetime="2019-09-01T00:18:36+08:00">2019-09-01</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">64k</span></div></div></header><div class="post-body" itemprop="articleBody"><p>æœ€è¿‘é‡æ–°å­¦äº†ä¸€ä¸‹ react æŠ€æœ¯æ ˆï¼Œé¡ºä¾¿é‡æ„äº†å»å¹´ä¸€ä¸ªç®¡ç†åå°ï¼Œä¸å¾—ä¸è¯´å‰ç«¯å˜åŒ–å®åœ¨æ˜¯å¤ªå¿«äº†ï¼Œå‡ ä¸ªæœˆæ²¡ç”¨ react ä»£ç éƒ½å¿«çœ‹ä¸æ‡‚äº†ã€‚</p><p>æºç åœ°å€ ğŸ‘‰<a target="_blank" rel="noopener" href="https://github.com/xiaojun1994/react-admin-lite">https://github.com/xiaojun1994/react-admin-lite</a></p><h2 id="ğŸŒµ-æŠ€æœ¯æ ˆ"><a href="#ğŸŒµ-æŠ€æœ¯æ ˆ" class="headerlink" title="ğŸŒµ æŠ€æœ¯æ ˆ"></a>ğŸŒµ æŠ€æœ¯æ ˆ</h2><p>åŸºäº cra ts ç‰ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npx create-react-app my-app --typescript</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">yarn create react-app my-app --typescript</span><br></pre></td></tr></table></figure><ul><li>react + hooks</li><li>react-router</li><li>mobx</li><li>typescript</li><li>antd</li><li>mockjs</li></ul><h2 id="ğŸ­-éœ€æ±‚åˆ†æ"><a href="#ğŸ­-éœ€æ±‚åˆ†æ" class="headerlink" title="ğŸ­ éœ€æ±‚åˆ†æ"></a>ğŸ­ éœ€æ±‚åˆ†æ</h2><ul><li>antd æŒ‰éœ€å¼•å…¥</li><li>æŒ‰é…ç½®æ–‡ä»¶è‡ªåŠ¨åˆ›å»ºèœå•</li><li>è·¯ç”±æ‡’åŠ è½½</li><li>å¿…é¡»ç™»å½•æ‰èƒ½è®¿é—®ï¼Œå¦‚æœæ²¡ç™»å½•ç›´æ¥é‡å®šå‘åˆ°ç™»å½•é¡µé¢</li><li>è®¿é—®äº†ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯ç”±è·³è½¬åˆ° 404 é¡µé¢</li><li>å®ç°è·¯ç”±çº§åˆ«å’ŒæŒ‰é’®çº§åˆ«çš„æƒé™æ§åˆ¶ï¼Œæ ¹æ®ç™»å½•ç”¨æˆ·å±•ç¤ºå¯¹åº”èœå•</li><li>ä½¿ç”¨ mock æ•°æ®</li><li>mobx çŠ¶æ€æŒä¹…åŒ–ï¼Œé¿å…åˆ·æ–°ä¸¢å¤±çŠ¶æ€</li></ul><h2 id="ğŸº-ç›®å½•"><a href="#ğŸº-ç›®å½•" class="headerlink" title="ğŸº ç›®å½•"></a>ğŸº ç›®å½•</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â”œâ”€â”€ config-overrides.js         rewiredé…ç½®</span><br><span class="line">â”œâ”€â”€ global.d.ts                 å­˜æ”¾ä¸€äº›tså…¨å±€å£°æ˜</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ public</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ favicon.ico</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index.html</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ logo192.png</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ logo512.png</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ manifest.json</span><br><span class="line">â”‚Â Â  â””â”€â”€ robots.txt</span><br><span class="line">â”œâ”€â”€ src</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ App.test.tsx</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ App.tsx</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ Layout                  å­˜æ”¾å¸ƒå±€ç»„ä»¶</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ assets                  å­˜æ”¾ä¸€äº›å›¾ç‰‡èµ„æº</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ common                  å­˜æ”¾ä¸€äº›å…¬å…±å˜é‡ã€æ–¹æ³•ç­‰</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ components              å­˜æ”¾å…¬å…±ç»„ä»¶</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ config                  å­˜æ”¾ä¸€äº›é…ç½®æ–‡ä»¶</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index.less</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ index.tsx</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ mock                    å­˜æ”¾mockæ•°æ®</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ pages</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ plugins                 å®é™…ä¸Šå°±æ”¾äº†ä¸€ä¸ªå°è£…åçš„axios</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ react-app-env.d.ts</span><br><span class="line">â”‚Â Â  â”œâ”€â”€ serviceWorker.ts</span><br><span class="line">â”‚Â Â  â””â”€â”€ store                   mobxä»“åº“</span><br><span class="line">â”œâ”€â”€ tsconfig.json</span><br><span class="line">â””â”€â”€ yarn.lock</span><br></pre></td></tr></table></figure><h2 id="ğŸ¬-æŒ‰éœ€å¼•å…¥-antd"><a href="#ğŸ¬-æŒ‰éœ€å¼•å…¥-antd" class="headerlink" title="ğŸ¬ æŒ‰éœ€å¼•å…¥ antd"></a>ğŸ¬ æŒ‰éœ€å¼•å…¥ antd</h2><p>å…ˆå®‰è£…è¿™å‡ ä¸ªä¾èµ– <code>babel-plugin-import</code> <code>customize-cra</code> <code>less</code> <code>less-loader</code> <code>react-app-rewired</code></p><p>æ ¹ç›®å½•ä¸‹æ–°å»º <code>config-overrides.js</code> å¹¶å†™å…¥ä»¥ä¸‹å†…å®¹</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// config-overrides.js</span></span><br><span class="line"><span class="keyword">const</span> &#123; override, fixBabelImports, addLessLoader, addDecoratorsLegacy &#125; = <span class="built_in">require</span>(<span class="string">&#x27;customize-cra&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="title function_">override</span>(</span><br><span class="line">  <span class="title function_">fixBabelImports</span>(<span class="string">&#x27;import&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">libraryName</span>: <span class="string">&#x27;antd&#x27;</span>,</span><br><span class="line">    <span class="attr">libraryDirectory</span>: <span class="string">&#x27;es&#x27;</span>,</span><br><span class="line">    <span class="attr">style</span>: <span class="literal">true</span></span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="title function_">addLessLoader</span>(&#123;</span><br><span class="line">    <span class="attr">javascriptEnabled</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">modifyVars</span>: &#123;</span><br><span class="line">      <span class="string">&#x27;@primary-color&#x27;</span>: <span class="string">&#x27;#8994DF&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="title function_">addDecoratorsLegacy</span>() <span class="comment">// é…ç½®ä»¥å…è®¸ä½¿ç”¨è£…é¥°å™¨</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ«å¿˜äº†æ”¹ä¸€ä¸‹ <code>package.json</code></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-app-rewired start&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;build&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-app-rewired build&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-app-rewired test&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;eject&quot;</span><span class="punctuation">:</span> <span class="string">&quot;react-scripts eject&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure><h2 id="ğŸ€-ç™»å½•æ§åˆ¶"><a href="#ğŸ€-ç™»å½•æ§åˆ¶" class="headerlink" title="ğŸ€ ç™»å½•æ§åˆ¶"></a>ğŸ€ ç™»å½•æ§åˆ¶</h2><p>æ²¡ç™»å½•è‡ªåŠ¨è·³åˆ°ç™»å½•é¡µé¢ï¼Œè¿™ä¸ªåŠŸèƒ½é€šè¿‡å°è£… <code>Route</code> ç»„ä»¶å®ç°ï¼Œè®©æˆ‘ä»¬å…ˆæä¸ª <code>AuthRoute</code>ã€‚</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/AuthRoute</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Route</span>, <span class="title class_">Redirect</span>, <span class="title class_">RouteProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> stores <span class="keyword">from</span> <span class="string">&#x27;../../store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">PickRequired</span>&lt;T, K <span class="keyword">extends</span> keyof T&gt; = T &amp; <span class="title class_">Required</span>&lt;<span class="title class_">Pick</span>&lt;T, K&gt;&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">AuthRoute</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;<span class="title class_">PickRequired</span>&lt;<span class="title class_">RouteProps</span>, <span class="string">&#x27;component&#x27;</span>&gt;&gt; = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; isLogged &#125; = <span class="title function_">useContext</span>(stores.<span class="property">userStore</span>)</span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">component</span>: <span class="title class_">Component</span>, ...rest &#125; = props</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Route</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#123;<span class="attr">...rest</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">render</span>=<span class="string">&#123;props</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">        return isLogged ? <span class="tag">&lt;<span class="name">Component</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span> : <span class="tag">&lt;<span class="name">Redirect</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#125;&#125;</span></span><br><span class="line"><span class="language-xml">    /&gt;</span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">AuthRoute</span></span><br></pre></td></tr></table></figure><h2 id="âš½ï¸-æŒ‰é…ç½®æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆèœå•"><a href="#âš½ï¸-æŒ‰é…ç½®æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆèœå•" class="headerlink" title="âš½ï¸ æŒ‰é…ç½®æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆèœå•"></a>âš½ï¸ æŒ‰é…ç½®æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆèœå•</h2><p><em>ä»¥ä¸‹æ•™ç¨‹ä¼šé€šè¿‡ <code>lazy</code> <code>Suspense</code> è®¾ç½®è·¯ç”±æ‡’åŠ è½½</em></p><h3 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// global.d.ts</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">IMenu</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span> <span class="comment">// èœå•å</span></span><br><span class="line">  <span class="attr">key</span>: <span class="built_in">string</span> <span class="comment">// èœå•å¯¹åº”è·¯ç”±</span></span><br><span class="line">  icon?: <span class="built_in">string</span> <span class="comment">// èœå•å›¾æ ‡</span></span><br><span class="line">  component?: <span class="title class_">React</span>.<span class="property">ComponentType</span>&lt;<span class="built_in">any</span>&gt; <span class="comment">// èœå•è·¯ç”±å¯¹åº”é¡µé¢</span></span><br><span class="line">  children?: <span class="title class_">IMenu</span>[] <span class="comment">// å­èœå•</span></span><br><span class="line">  permissions?: <span class="title class_">Permission</span>[] <span class="comment">// èœå•æƒé™</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// src/config/menus.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; lazy &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">menus</span>: <span class="title class_">IMenu</span>[] = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;åˆä½œå•†æˆ·&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/information&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;user&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../pages/Information&#x27;</span>)),</span><br><span class="line">    <span class="attr">permissions</span>: [<span class="string">&#x27;admin&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;è®¢å•æŸ¥è¯¢&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/order-query&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;file-text&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../pages/OrderQuery&#x27;</span>)),</span><br><span class="line">    <span class="attr">permissions</span>: [<span class="string">&#x27;admin&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;äº¤æ˜“æŸ¥è¯¢&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/trade-query&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;pay-circle&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../pages/TradeQuery&#x27;</span>)),</span><br><span class="line">    <span class="attr">permissions</span>: [<span class="string">&#x27;admin&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;æŠ¥è¡¨å¯¼å‡º&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/reports&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;upload&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../pages/Reports&#x27;</span>)),</span><br><span class="line">    <span class="attr">permissions</span>: [<span class="string">&#x27;admin&#x27;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;ä¸€çº§èœå•&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/level1&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;man&#x27;</span>,</span><br><span class="line">    <span class="attr">children</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;äºŒçº§èœå•&#x27;</span>,</span><br><span class="line">        <span class="attr">key</span>: <span class="string">&#x27;/level2&#x27;</span>,</span><br><span class="line">        <span class="attr">icon</span>: <span class="string">&#x27;woman&#x27;</span>,</span><br><span class="line">        <span class="attr">children</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;ä¸‰çº§èœå•&#x27;</span>,</span><br><span class="line">            <span class="attr">key</span>: <span class="string">&#x27;/level3&#x27;</span>,</span><br><span class="line">            <span class="attr">icon</span>: <span class="string">&#x27;api&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>: <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../pages/Hello&#x27;</span>))</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;æƒé™æµ‹è¯•&#x27;</span>,</span><br><span class="line">    <span class="attr">key</span>: <span class="string">&#x27;/permission&#x27;</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;medicine-box&#x27;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title function_">lazy</span>(<span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;../pages/Permission&#x27;</span>))</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> menus</span><br></pre></td></tr></table></figure><h3 id="å°è£…-Menus-ç»„ä»¶"><a href="#å°è£…-Menus-ç»„ä»¶" class="headerlink" title="å°è£… Menus ç»„ä»¶"></a>å°è£… Menus ç»„ä»¶</h3><p>Menus ç»„ä»¶è´Ÿè´£æ ¹æ®é…ç½®æ–‡ä»¶é€’å½’ç”Ÿæˆä¾§è¾¹èœå•</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/Menus</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Icon</span>, <span class="title class_">Menu</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">ClickParam</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd/lib/menu&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; withRouter, <span class="title class_">RouteComponentProps</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;../../config/menus&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; usePermission &#125; <span class="keyword">from</span> <span class="string">&#x27;../../common/hooks&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Menus</span>: <span class="title class_">React</span>.<span class="property">FC</span>&lt;<span class="title class_">RouteComponentProps</span>&gt; = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; location, history &#125; = props</span><br><span class="line">  <span class="keyword">const</span> hasPermission = <span class="title function_">usePermission</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleNavClick</span>(<span class="params">&#123; key &#125;: ClickParam</span>) &#123;</span><br><span class="line">    history.<span class="title function_">push</span>(key)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">hasChild</span>(<span class="params">menu: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">isArray</span>(menu.<span class="property">children</span>) &amp;&amp; menu.<span class="property">children</span>.<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">genSubMenu</span>(<span class="params">menu: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.SubMenu</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">title</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &lt;<span class="attr">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;menu.icon &amp;&amp; <span class="tag">&lt;<span class="name">Icon</span> <span class="attr">type</span>=<span class="string">&#123;menu.icon&#125;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;menu.name&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">        key=&#123;menu.key&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        &#123;genMenus(menu.children)&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu.SubMenu</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">genMenItem</span>(<span class="params">menu: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">Menu.Item</span> <span class="attr">key</span>=<span class="string">&#123;menu.key&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;menu.icon &amp;&amp; <span class="tag">&lt;<span class="name">Icon</span> <span class="attr">type</span>=<span class="string">&#123;menu.icon&#125;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;menu.name&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Menu.Item</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">genMenus</span>(<span class="params">menus: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> menus.<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev: <span class="built_in">any</span>, next: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> prev.<span class="title function_">concat</span>(</span><br><span class="line">        <span class="title function_">hasChild</span>(next)</span><br><span class="line">          ? <span class="title function_">hasPermission</span>(next) &amp;&amp; <span class="title function_">genSubMenu</span>(next)</span><br><span class="line">          : <span class="title function_">hasPermission</span>(next) &amp;&amp; <span class="title function_">genMenItem</span>(next)</span><br><span class="line">      )</span><br><span class="line">    &#125;, [])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Menu</span> <span class="attr">theme</span>=<span class="string">&quot;dark&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;inline&quot;</span> <span class="attr">selectedKeys</span>=<span class="string">&#123;[location.pathname]&#125;</span> <span class="attr">onClick</span>=<span class="string">&#123;handleNavClick&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;genMenus(menus)&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Menu</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">withRouter</span>(<span class="title class_">Menus</span>)</span><br></pre></td></tr></table></figure><h3 id="å°è£…-Content-ç»„ä»¶"><a href="#å°è£…-Content-ç»„ä»¶" class="headerlink" title="å°è£… Content ç»„ä»¶"></a>å°è£… Content ç»„ä»¶</h3><p>Content ç»„ä»¶è´Ÿè´£æ ¹æ®é…ç½®æ–‡ä»¶é€’å½’ç”Ÿæˆè·¯ç”±</p><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/Content</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; <span class="title class_">Suspense</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Layout</span>, <span class="title class_">Spin</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Switch</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;react-router-dom&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AuthRoute</span> <span class="keyword">from</span> <span class="string">&#x27;../AuthRoute&#x27;</span></span><br><span class="line"><span class="keyword">import</span> menus <span class="keyword">from</span> <span class="string">&#x27;../../config/menus&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NoMatch</span> <span class="keyword">from</span> <span class="string">&#x27;../../pages/404&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; usePermission &#125; <span class="keyword">from</span> <span class="string">&#x27;../../common/hooks&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Content</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> hasPermission = <span class="title function_">usePermission</span>()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">hasChild</span>(<span class="params">menu: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">isArray</span>(menu.<span class="property">children</span>) &amp;&amp; menu.<span class="property">children</span>.<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">genRoute</span>(<span class="params">menu: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!menu.<span class="property">component</span>) <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">AuthRoute</span> <span class="attr">path</span>=<span class="string">&#123;menu.key&#125;</span> <span class="attr">component</span>=<span class="string">&#123;menu.component&#125;</span> <span class="attr">key</span>=<span class="string">&#123;menu.key&#125;</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">genRoutes</span>(<span class="params">menus: <span class="built_in">any</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> menus.<span class="title function_">reduce</span>(<span class="function">(<span class="params">prev: <span class="built_in">any</span>, next: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> prev.<span class="title function_">concat</span>(</span><br><span class="line">        <span class="title function_">hasChild</span>(next)</span><br><span class="line">          ? <span class="title function_">hasPermission</span>(next) &amp;&amp; <span class="title function_">genRoutes</span>(next.<span class="property">children</span>)</span><br><span class="line">          : <span class="title function_">hasPermission</span>(next) &amp;&amp; <span class="title function_">genRoute</span>(next)</span><br><span class="line">      )</span><br><span class="line">    &#125;, [])</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Layout.Content</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      <span class="attr">style</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">margin:</span> &#x27;<span class="attr">24px</span>&#x27;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Suspense</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">fallback</span>=<span class="string">&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &lt;<span class="attr">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">textAlign:</span> &#x27;<span class="attr">center</span>&#x27;, <span class="attr">marginTop:</span> &#x27;<span class="attr">50px</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Spin</span> <span class="attr">tip</span>=<span class="string">&quot;Loading...&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;genRoutes(menus)&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">AuthRoute</span> <span class="attr">component</span>=<span class="string">&#123;NoMatch&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Layout.Content</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Content</span></span><br></pre></td></tr></table></figure><h2 id="ğŸš-æŒ‰é’®çº§åˆ«æƒé™æ§åˆ¶"><a href="#ğŸš-æŒ‰é’®çº§åˆ«æƒé™æ§åˆ¶" class="headerlink" title="ğŸš æŒ‰é’®çº§åˆ«æƒé™æ§åˆ¶"></a>ğŸš æŒ‰é’®çº§åˆ«æƒé™æ§åˆ¶</h2><p>ä¸Šé¢æˆ‘ä»¬å·²ç»å®ç°äº†èœå•çº§åˆ«æƒé™æ§åˆ¶ï¼Œä½†æ˜¯è¿™è¿˜ä¸å¤Ÿï¼Œå¯èƒ½æœ‰æ—¶å€™è¿˜éœ€è¦æŒ‰é’®çº§åˆ«æƒé™æ§åˆ¶</p><h3 id="è‡ªå®šä¹‰-hooks"><a href="#è‡ªå®šä¹‰-hooks" class="headerlink" title="è‡ªå®šä¹‰ hooks"></a>è‡ªå®šä¹‰ hooks</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/common/hooks.tsx</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span>, &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; userStore &#125; <span class="keyword">from</span> <span class="string">&#x27;../store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†æŒ‰é’®çº§åˆ«æƒé™ï¼Œç±»ä¼¼é«˜é˜¶ç»„ä»¶</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useAuthComponent</span>(<span class="params">...permissions: Permission[]</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; userinfo &#125; = <span class="title function_">useContext</span>(userStore)</span><br><span class="line">  <span class="keyword">const</span> hasPermission = permissions.<span class="title function_">includes</span>(userinfo.<span class="property">permission</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &lt;P <span class="keyword">extends</span> &#123;&#125;&gt;(<span class="title class_">BaseComponent</span>: <span class="title class_">React</span>.<span class="property">ComponentType</span>&lt;P&gt;): <span class="title class_">React</span>.<span class="property">FC</span>&lt;P&gt; =&gt; <span class="function"><span class="params">props</span> =&gt;</span></span><br><span class="line">    hasPermission ? <span class="language-xml"><span class="tag">&lt;<span class="name">BaseComponent</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span> : <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; usePermission, useAuthComponent &#125;</span><br></pre></td></tr></table></figure><p><em>è¿™ä¸ª hooks æˆ‘å°è£…çš„ä¸æ˜¯å¾ˆå¥½ï¼Œä»¥åçœ‹èƒ½å¦ä¼˜åŒ–</em></p><h3 id="ä½¿ç”¨æ•™ç¨‹"><a href="#ä½¿ç”¨æ•™ç¨‹" class="headerlink" title="ä½¿ç”¨æ•™ç¨‹"></a>ä½¿ç”¨æ•™ç¨‹</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Button</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;antd&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; observer &#125; <span class="keyword">from</span> <span class="string">&#x27;mobx-react-lite&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useAuthComponent &#125; <span class="keyword">from</span> <span class="string">&#x27;../common/hooks&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Permission</span>: <span class="title class_">React</span>.<span class="property">FC</span> = <span class="function"><span class="params">props</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// @ts-ignore æŸäº›ç»„ä»¶ä¼šæŠ¥é”™ï¼Œå¿½ç•¥å®ƒ</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title class_">AuthButton</span> = <span class="title function_">useAuthComponent</span>(<span class="string">&#x27;admin&#x27;</span>)(<span class="title class_">Button</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">AuthButton</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span>&gt;</span>æƒé™ä¸ºadminè¯¥æŒ‰é’®æ‰æ˜¾ç¤º<span class="tag">&lt;/<span class="name">AuthButton</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">observer</span>(<span class="title class_">Permission</span>)</span><br></pre></td></tr></table></figure><h2 id="ğŸ‰-ä½¿ç”¨-mock-æ•°æ®"><a href="#ğŸ‰-ä½¿ç”¨-mock-æ•°æ®" class="headerlink" title="ğŸ‰ ä½¿ç”¨ mock æ•°æ®"></a>ğŸ‰ ä½¿ç”¨ mock æ•°æ®</h2><p>éœ€è¦å®‰è£… <code>mockjs</code></p><p>ç®€å•ç¤ºä¾‹ï¼Œå…·ä½“è¯·ç§»æ­¥å®˜ç½‘</p><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Mock</span> <span class="keyword">from</span> <span class="string">&#x27;mockjs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">setup</span>(&#123;</span><br><span class="line">  <span class="comment">// æ¨¡æ‹Ÿå»¶è¿Ÿï¼ˆ200-600æ¯«ç§’ä¹‹é—´ï¼‰</span></span><br><span class="line">  <span class="attr">timeout</span>: <span class="string">&#x27;200-600&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">mock</span>(<span class="regexp">/login/</span>, <span class="function">(<span class="params">val: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> isAdmin = val.<span class="property">url</span>.<span class="title function_">match</span>(<span class="regexp">/admin/</span>)</span><br><span class="line">  <span class="keyword">return</span> isAdmin</span><br><span class="line">    ? &#123;</span><br><span class="line">        <span class="attr">t</span>: &#123;</span><br><span class="line">          <span class="attr">account</span>: <span class="string">&#x27;admin@xxx.com&#x27;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">          <span class="attr">permission</span>: <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    : &#123;</span><br><span class="line">        <span class="attr">t</span>: &#123;</span><br><span class="line">          <span class="attr">account</span>: <span class="string">&#x27;guest@xxx.com&#x27;</span>,</span><br><span class="line">          <span class="attr">name</span>: <span class="string">&#x27;guest&#x27;</span>,</span><br><span class="line">          <span class="attr">permission</span>: <span class="string">&#x27;guest&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">mock</span>(<span class="regexp">/getMerchantInfo/</span>, &#123;</span><br><span class="line">  <span class="attr">t</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;account|3-8&#x27;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;@cname&#x27;</span>,</span><br><span class="line">        <span class="attr">account</span>: <span class="string">&#x27;@email&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">&#x27;product|5-10&#x27;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&#x27;productId|5&#x27;</span>: <span class="regexp">/\d/</span>,</span><br><span class="line">        <span class="string">&#x27;productType|1&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>],</span><br><span class="line">        <span class="string">&#x27;status|0-1&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&#x27;road|5-10&#x27;</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;æµ‹è¯•å•†æˆ·&#x27;</span>,</span><br><span class="line">            <span class="attr">roadCode</span>: <span class="regexp">/10021\d&#123;6&#125;/</span>,</span><br><span class="line">            <span class="string">&#x27;status|0-1&#x27;</span>: <span class="number">0</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">mock</span>(<span class="regexp">/order-query/</span>, &#123;</span><br><span class="line">  <span class="attr">t</span>: &#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">mock</span>(<span class="regexp">/trade-query/</span>, &#123;</span><br><span class="line">  <span class="string">&#x27;t|10&#x27;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&#x27;id|+1&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">      <span class="attr">merOrderNo</span>: <span class="regexp">/\d&#123;12&#125;/</span>,</span><br><span class="line">      <span class="attr">payOrderId</span>: <span class="regexp">/\d&#123;12&#125;/</span>,</span><br><span class="line">      <span class="attr">roadCode</span>: <span class="regexp">/10021\d&#123;6&#125;/</span>,</span><br><span class="line">      <span class="attr">merName</span>: <span class="string">&#x27;@word()&#x27;</span>,</span><br><span class="line">      <span class="string">&#x27;amount|10-10000.2-2&#x27;</span>: <span class="number">10</span>,</span><br><span class="line">      <span class="string">&#x27;status|1&#x27;</span>: [<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>],</span><br><span class="line">      <span class="attr">createTime</span>: <span class="string">&quot;@date(&#x27;yyyy-MM-dd hh:mm:ss&#x27;)&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä¹‹ååœ¨ App.tsx å¼•å…¥å®ƒå³å¯</p><h2 id="ğŸ¤¡-mobx-æŒä¹…åŒ–å­˜å‚¨"><a href="#ğŸ¤¡-mobx-æŒä¹…åŒ–å­˜å‚¨" class="headerlink" title="ğŸ¤¡ mobx æŒä¹…åŒ–å­˜å‚¨"></a>ğŸ¤¡ mobx æŒä¹…åŒ–å­˜å‚¨</h2><h3 id="å¾ˆç®€é™‹ï¼Œå‡‘åˆç”¨"><a href="#å¾ˆç®€é™‹ï¼Œå‡‘åˆç”¨" class="headerlink" title="å¾ˆç®€é™‹ï¼Œå‡‘åˆç”¨"></a>å¾ˆç®€é™‹ï¼Œå‡‘åˆç”¨</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/common/utils.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; autorun &#125; <span class="keyword">from</span> <span class="string">&#x27;mobx&#x27;</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * mobx çŠ¶æ€æŒä¹…åŒ–</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">let</span> is_first_run = <span class="literal">true</span></span><br><span class="line"><span class="keyword">function</span> mobxPersist&lt;T, K <span class="keyword">extends</span> keyof T&gt;(<span class="attr">store</span>: T, <span class="attr">fields</span>: K[]): T &#123;</span><br><span class="line">  <span class="title function_">autorun</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    fields.<span class="title function_">forEach</span>(<span class="function"><span class="params">field</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (is_first_run) &#123;</span><br><span class="line">        <span class="keyword">const</span> data = <span class="variable language_">window</span>.<span class="property">sessionStorage</span>.<span class="title function_">getItem</span>(field <span class="keyword">as</span> <span class="built_in">string</span>)</span><br><span class="line">        data &amp;&amp; (store[field] = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(data))</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="property">sessionStorage</span>.<span class="title function_">setItem</span>(field <span class="keyword">as</span> <span class="built_in">string</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(store[field]))</span><br><span class="line">    &#125;)</span><br><span class="line">    is_first_run = <span class="literal">false</span></span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> store</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; mobxPersist &#125;</span><br></pre></td></tr></table></figure><h3 id="ä½¿ç”¨æ•™ç¨‹-1"><a href="#ä½¿ç”¨æ•™ç¨‹-1" class="headerlink" title="ä½¿ç”¨æ•™ç¨‹"></a>ä½¿ç”¨æ•™ç¨‹</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; observable, action, computed &#125; <span class="keyword">from</span> <span class="string">&#x27;mobx&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; mobxPersist &#125; <span class="keyword">from</span> <span class="string">&#x27;../../common/utils&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> <span class="title class_">UserStore</span> &#123;</span><br><span class="line">  <span class="meta">@observable</span> <span class="attr">userinfo</span>: <span class="built_in">any</span> = &#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@action</span></span><br><span class="line">  saveUserinfo = <span class="function">(<span class="params">data: <span class="built_in">any</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">userinfo</span> = data</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@computed</span></span><br><span class="line">  <span class="keyword">get</span> <span class="title function_">isLogged</span>() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="variable language_">this</span>.<span class="property">userinfo</span>).<span class="property">length</span> &gt; <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@action</span></span><br><span class="line">  cleanUserinfo = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">userinfo</span> = &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">createContext</span>(<span class="title function_">mobxPersist</span>(<span class="keyword">new</span> <span class="title class_">UserStore</span>(), [<span class="string">&#x27;userinfo&#x27;</span>]))</span><br></pre></td></tr></table></figure><h2 id="ğŸŒ-ç»“å°¾"><a href="#ğŸŒ-ç»“å°¾" class="headerlink" title="ğŸŒ ç»“å°¾"></a>ğŸŒ ç»“å°¾</h2><p>æš‚æ—¶å†™è¿™ä¹ˆå¤šï¼Œæ„Ÿè§‰è¿˜æœ‰å¾ˆå¤§ä¼˜åŒ–ç©ºé—´ï¼Œç­‰æˆ‘æ…¢æ…¢å®Œå–„ï¼Œts ç»™æˆ‘æ„Ÿè§‰å°±åƒè‡­è±†è…ä¸€æ ·ï¼Œé—»ç€è‡­ï¼Œåƒç€è¿˜è¡Œ~ğŸ¤–</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/93f7cf6a.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/93f7cf6a.html" itemprop="url">ä¸€äº›iTerm2å¸¸è§é—®é¢˜</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2019-06-26 22:52:29" itemprop="dateCreated datePublished" datetime="2019-06-26T22:52:29+08:00">2019-06-26</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">403</span></div></div></header><div class="post-body" itemprop="articleBody"><p><em>1. è§£å†³ no matches found é—®é¢˜</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;setopt no_nomatch&quot;</span> &gt;&gt; ~/.zshrc &amp;&amp; <span class="built_in">source</span> ~/.zshrc</span><br></pre></td></tr></table></figure></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/43b36ae9.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/43b36ae9.html" itemprop="url">æ€æ ·è®¾ç½®SSHä»£ç†</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2019-06-12 13:19:45" itemprop="dateCreated datePublished" datetime="2019-06-12T13:19:45+08:00">2019-06-12</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">1.9k</span></div></div></header><div class="post-body" itemprop="articleBody"><p>ç”±äºæœ¬äººæœåŠ¡å™¨ ip è¢«å°ï¼Œå¯¼è‡´å›½å†…æ— æ³•ç›´è¿ï¼Œåªå¥½è®¾ç½®ä»£ç†è¿æ¥äº† f**kâ€¼ï¸</p><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2><p>åœ¨ç³»ç»Ÿ <code>.ssh</code> ç›®å½•ä¸‹ç¼–è¾‘ <code>config</code> æ–‡ä»¶ï¼ˆæ²¡æœ‰å°±æ–°å»ºä¸€ä¸ªï¼‰ï¼Œè·¯å¾„ä¸€èˆ¬æ˜¯ <code>C:\Users\xxx\.ssh</code>ï¼Œå…¶ä¸­ <code>xxx</code> ä¸ºä½ ç”µè„‘ç”¨æˆ·å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host x.x.x.x</span><br><span class="line">  ProxyCommand connect -S 127.0.0.1:xxxx %h %p</span><br></pre></td></tr></table></figure><h2 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a>macOS</h2><p>ç¼–è¾‘ <code>~/.ssh/config</code> æ–‡ä»¶ï¼ˆæ²¡æœ‰å°±æ–°å»ºä¸€ä¸ªï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host x.x.x.x</span><br><span class="line">	ProxyCommand nc -x 127.0.0.1:xxxx %h %p</span><br></pre></td></tr></table></figure><h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>ã€‚ã€‚</p><p>ã€‚ã€‚</p><p>ã€‚ã€‚</p><p>å†è®°å½•ä¸€ä¸‹ git è®¾ç½® http ä»£ç†æ–¹å¼å§ï¼Œé€šè¿‡å‘½ä»¤å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxyÂ <span class="string">&#x27;http://127.0.0.1:1080&#x27;</span></span><br><span class="line">git config --global https.proxyÂ <span class="string">&#x27;http://127.0.0.1:1080&#x27;</span></span><br><span class="line">git config --global http.proxyÂ <span class="string">&#x27;socks5://127.0.0.1:1080&#x27;</span></span><br><span class="line">git config --global https.proxyÂ <span class="string">&#x27;socks5://127.0.0.1:1080&#x27;</span></span><br></pre></td></tr></table></figure><p><em>å…·ä½“è®¾ç½®è§†ä½ æƒ…å†µè€Œå®š</em></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/77ae3463.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/77ae3463.html" itemprop="url">v2rayæ­å»ºæµç¨‹</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2019-06-11 10:15:39" itemprop="dateCreated datePublished" datetime="2019-06-11T10:15:39+08:00">2019-06-11</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">3.2k</span></div></div></header><div class="post-body" itemprop="articleBody"><p>ä½¿ç”¨ v2ray ä¸€é”®è„šæœ¬</p><p><a target="_blank" rel="noopener" href="https://github.com/233boy/v2ray/wiki">https://github.com/233boy/v2ray/wiki</a></p><p>æ¨èä½¿ç”¨ Cloudflare ä¸­è½¬ V2Ray æµé‡ï¼Œè¿™é‡Œè¯´ä¿©æ³¨é‡ç‚¹</p><ul><li><p>Cloudflare æ˜¯éœ€è¦åŸŸåçš„ï¼Œæ¨èä¸€ä¸ªç”³è¯·å…è´¹åŸŸåçš„ç½‘ç«™ <a target="_blank" rel="noopener" href="https://www.freenom.com/">https://www.freenom.com</a></p></li><li><p>å…³äº Caddy å¯åŠ¨å¤±è´¥çš„é—®é¢˜ï¼Œæ˜¯å› ä¸º Caddy ä¸ Nginx æœ‰å†²çªï¼Œä½ å¯ä»¥æŠ›å¼ƒ Caddy è€Œä½¿ç”¨ Nginxï¼Œæ”¾ä¸€ä»½æˆ‘çš„é…ç½®</p></li></ul><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>                    <span class="number">443</span>;</span><br><span class="line">    <span class="attribute">server_name</span>               xiaojun1994.cf; <span class="comment"># åˆšæ‰ç”³è¯·çš„åŸŸå</span></span><br><span class="line">    <span class="attribute">ssl</span>                       <span class="literal">on</span>;</span><br><span class="line">    <span class="attribute">ssl_certificate</span>           /srv/ssl/2332201_xiaojun1994.cf.pem;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span>       /srv/ssl/2332201_xiaojun1994.cf.key;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span>               ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span><br><span class="line">    <span class="attribute">ssl_protocols</span>             TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span>            http://localhost:45018; <span class="comment"># è¿™å„¿å¡«ä¸ºä½  v2ray ç«¯å£ï¼ŒæŸ¥çœ‹æ–¹æ³•ï¼švim /etc/v2ray/config.json -&gt; inbounds -&gt; port</span></span><br><span class="line">        <span class="attribute">proxy_http_version</span>    <span class="number">1</span>.<span class="number">1</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span>      Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        <span class="attribute">proxy_set_header</span>      Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><em>ssl ç”³è¯·æ–¹æ³•è¯·æŸ¥çœ‹<a href="/posts/8ae1c1bd.html">è¿™ç¯‡æ–‡ç« </a></em></p><h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>æ™šä¸Š v2ray ç›¸æ¯” ss è¿˜æ˜¯è¦æ…¢ä¸€ç‚¹ï¼Œä¸è¿‡ç¨³å®šå°±å¥½ï¼Œå› ä¸ºå¥—äº† cdn çš„åŸå› ï¼Œä½ æœåŠ¡å™¨ ip è¢«å°äº†ä»ç„¶è¿˜èƒ½ç”¨ ğŸ¶~</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/13337c2f.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/13337c2f.html" itemprop="url">ä½¿ç”¨yumå¿«é€Ÿå®‰è£…æœ€æ–°ç‰ˆnodejs</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2019-05-13 16:50:25" itemprop="dateCreated datePublished" datetime="2019-05-13T16:50:25+08:00">2019-05-13</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">476</span></div></div></header><div class="post-body" itemprop="articleBody"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -sL https://rpm.nodesource.com/setup_10.x | bash -</span><br><span class="line">sudo yum install -y nodejs</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå‘½ä»¤ä»£è¡¨æˆ‘æƒ³å®‰è£… Node10 æœ€æ–°ç‰ˆæœ¬ï¼Œæ›´å¤šç‰ˆæœ¬å‚è§ <a target="_blank" rel="noopener" href="https://github.com/nodesource/distributions">https://github.com/nodesource/distributions</a></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/fa3efcda.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/fa3efcda.html" itemprop="url">è§„èŒƒåŒ–Gitåˆä½œæµç¨‹</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2019-03-11 17:07:47" itemprop="dateCreated datePublished" datetime="2019-03-11T17:07:47+08:00">2019-03-11</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">16k</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="Commitizen"><a href="#Commitizen" class="headerlink" title="Commitizen"></a>Commitizen</h2><p>çºµè§‚é‚£äº› GitHub ä¸Š star å¾ˆå¤šçš„å¼€æºåº“ï¼Œå¼€å‘æµç¨‹éƒ½æ˜¯æå…¶è§„èŒƒçš„ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/commitizen/cz-cli">Commitizen</a> ä¾¿æ˜¯ç”¨æ¥è§„èŒƒåŒ– git æäº¤ä¿¡æ¯çš„ä¸€ä¸ªå¥½å·¥å…·ã€‚</p><div class="img-container" data-caption="Vue çš„ commit message">![AP2yb6.png](https://s2.ax1x.com/2019/03/12/AP2yb6.png)</div><p><code>commitizen</code> é€šå¸¸è¦ä¸é€‚é…å™¨ä¸€èµ·ä½¿ç”¨ï¼Œé€šä¿—ç‚¹æ¥è¯´æ˜¯éœ€è¦ä¸€ä¸ª commit message æ¨¡æ¿ï¼Œç›®å‰ä¸»æµçš„æ˜¯ç¬¦åˆ Angular è§„èŒƒçš„ <code>cz-conventional-changelog</code>ã€‚</p><h3 id="âœ¨-å®‰è£…"><a href="#âœ¨-å®‰è£…" class="headerlink" title="âœ¨ å®‰è£…"></a>âœ¨ å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm i -g commitizen</span><br><span class="line">npm i -g cz-conventional-changelog</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;&#123; &quot;path&quot;: &quot;cz-conventional-changelog&quot; &#125;&#x27;</span> &gt; ~/.czrc</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå‘½ä»¤ä»£è¡¨å…¨å±€ä½¿ç”¨ <code>cz-conventional-changelog</code> é€‚é…å™¨ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥å±€éƒ¨å®‰è£…é€‚é…å™¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿™ç§æ–¹å¼æ˜¯ä½¿ç”¨npmæ¥å®‰è£…</span></span><br><span class="line">commitizen init cz-conventional-changelog --save-dev --save-exact</span><br><span class="line"><span class="comment"># è¿™ç§æ–¹å¼æ˜¯ä½¿ç”¨yarnæ¥å®‰è£…</span></span><br><span class="line">commitizen init cz-conventional-changelog --yarn --dev --exact</span><br></pre></td></tr></table></figure><p>å‡å¦‚ä½ å·²ç»å…¨å±€å®‰è£…äº†é€‚é…å™¨ï¼Œé‚£ä¹ˆä¸Šé¢çš„å‘½ä»¤ä¼šæŠ¥ _A previous adapter is already configured. Use â€“force to override_ï¼Œå¦‚å®ƒæ‰€è¯´ï¼Œåªéœ€è¦åŠ ä¸Š <code>--force</code> å‚æ•°å³å¯å¼ºåˆ¶ä½¿ç”¨å±€éƒ¨é€‚é…å™¨ï¼ŒæˆåŠŸåä¼šåœ¨æœ¬åœ°å±€éƒ¨å®‰è£… <code>cz-conventional-changelog</code>ï¼Œå¹¶åœ¨ <code>package.json</code> ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;cz-conventional-changelog&quot;</span><span class="punctuation">:</span> <span class="string">&quot;^2.1.0&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;config&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;commitizen&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./node_modules/cz-conventional-changelog&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ğŸ‰-ä½¿ç”¨"><a href="#ğŸ‰-ä½¿ç”¨" class="headerlink" title="ğŸ‰ ä½¿ç”¨"></a>ğŸ‰ ä½¿ç”¨</h3><p>å®‰è£…æˆåŠŸåå³å¯é€šè¿‡å‘½ä»¤ <code>git-cz</code> æ¥ä»£æ›¿ <code>git commit</code> è¿›è¡Œæäº¤äº†</p><p><img src="https://s2.ax1x.com/2019/03/12/AP6OPJ.png" alt="AP6OPJ.png"></p><p><em><code>git-cz</code> å…·æœ‰ <code>git commit</code> ä¸€åˆ‡å‚æ•°ï¼Œå°±åƒè¿™æ ·ï¼š <code>git-cz -a</code></em></p><p><code>VSCode</code> ç”¨æˆ·å¯ä»¥å®‰è£…ä¸€ä¸ª <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=KnisterPeter.vscode-commitizen">Visual Studio Code Commitizen Support</a> æ‰©å±•ä»¥ä½¿ç”¨æ›´å‹å¥½çš„ commit ç•Œé¢ï¼Œ<br>æŒ‰ä¸‹ <code>F1</code>ï¼Œè¾“å…¥ <code>conventional commit</code>ï¼Œæ•ˆæœå¦‚ä¸‹</p><p><img src="https://s2.ax1x.com/2019/03/12/APgNpd.png" alt="APgNpd.png">æ ¹æ®æ­¥éª¤æ“ä½œå°± ok äº†ã€‚</p><hr><h2 id="Standard-Version"><a href="#Standard-Version" class="headerlink" title="Standard Version"></a>Standard Version</h2><h3 id="ğŸˆ-ç”¨é€”"><a href="#ğŸˆ-ç”¨é€”" class="headerlink" title="ğŸˆ ç”¨é€”"></a>ğŸˆ ç”¨é€”</h3><ul><li>è‡ªåŠ¨å‡çº§ <em>version</em></li><li>è‡ªåŠ¨ç”Ÿæˆ <em>changelog</em></li><li>è‡ªåŠ¨æ‰“ <em>tag</em></li></ul><p><em>æ¯æ¬¡æ›´æ–°ç‰ˆæœ¬åä¼šè‡ªåŠ¨å°† <code>package.json(et al.)</code> å’Œ <code>CHANGELOG.md</code> æäº¤</em></p><div class="note warning"><p>å¿…é¡»ç¡®ä¿ Commit Message ç¬¦åˆ <a target="_blank" rel="noopener" href="https://conventionalcommits.org/">Conventional Commits</a> è§„èŒƒå“¦ï¼ä¸Šé¢ä½¿ç”¨çš„ <code>cz-conventional-changelog</code> æ˜¯ç¬¦åˆè¿™ä¸ªè§„èŒƒçš„ã€‚</p></div><div class="img-container" data-caption="ä½¿ç”¨ Standard Version è‡ªåŠ¨ç”Ÿæˆçš„ changelog">![Ai9KgJ.png](https://s2.ax1x.com/2019/03/12/Ai9KgJ.png)</div><h3 id="ğŸ„-å®‰è£…"><a href="#ğŸ„-å®‰è£…" class="headerlink" title="ğŸ„ å®‰è£…"></a>ğŸ„ å®‰è£…</h3><p>è¿™é‡Œæˆ‘é€‰æ‹©å…¨å±€å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i -g standard-version</span><br></pre></td></tr></table></figure><p>æ–¹ä¾¿èµ·è§ï¼Œé¦–å…ˆæ–°å¢ä¸€ä¸ª npm run script</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;release&quot;</span><span class="punctuation">:</span> <span class="string">&quot;standard-version&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ğŸ€-å‘å¸ƒç¬¬ä¸€ç‰ˆ"><a href="#ğŸ€-å‘å¸ƒç¬¬ä¸€ç‰ˆ" class="headerlink" title="ğŸ€ å‘å¸ƒç¬¬ä¸€ç‰ˆ"></a>ğŸ€ å‘å¸ƒç¬¬ä¸€ç‰ˆ</h3><p>å‘å¸ƒç¬¬ä¸€ç‰ˆæ—¶è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¿™æ¡å‘½ä»¤ä¸ä¼šä¿®æ”¹ç‰ˆæœ¬å·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run release -- -f</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">standard-version -f</span><br></pre></td></tr></table></figure><h3 id="ğŸ-å‡çº§ä¸€ä¸ªç‰ˆæœ¬"><a href="#ğŸ-å‡çº§ä¸€ä¸ªç‰ˆæœ¬" class="headerlink" title="ğŸ å‡çº§ä¸€ä¸ªç‰ˆæœ¬"></a>ğŸ å‡çº§ä¸€ä¸ªç‰ˆæœ¬</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run release</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">standard-version</span><br></pre></td></tr></table></figure><h3 id="ğŸ¨-ç”Ÿæˆä¸€ä¸ªé¢„å‘å¸ƒç‰ˆæœ¬"><a href="#ğŸ¨-ç”Ÿæˆä¸€ä¸ªé¢„å‘å¸ƒç‰ˆæœ¬" class="headerlink" title="ğŸ¨ ç”Ÿæˆä¸€ä¸ªé¢„å‘å¸ƒç‰ˆæœ¬"></a>ğŸ¨ ç”Ÿæˆä¸€ä¸ªé¢„å‘å¸ƒç‰ˆæœ¬</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run release -- -p</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">standard-version -p</span><br></pre></td></tr></table></figure><p>ä¼šå¾—åˆ°ä¸€ä¸ªç±»ä¼¼ <code>1.0.1-0</code> <code>1.0.1-1</code> â€¦ è¿™ç§ç‰ˆæœ¬<br>å¦‚æœå¸Œæœ›ä¸ºé¢„å‘å¸ƒç‰ˆæœ¬å‘½åï¼Œå¯ä»¥é€šè¿‡ <code>--prerelease &lt;name&gt;</code> æŒ‡å®šåç§°ã€‚<br>ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨çš„é¢„å‘è¡Œç‰ˆåº”è¯¥åŒ…å« alpha å‰ç¼€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run release -- -p alpha</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">standard-version -p alpha</span><br></pre></td></tr></table></figure><p>è¿™å°†å¾—åˆ°ä¸€ä¸ª <code>1.0.1-alpha.0</code> ç‰ˆæœ¬</p><h3 id="ğŸ-æ‰‹åŠ¨é€‰æ‹©ç‰ˆæœ¬"><a href="#ğŸ-æ‰‹åŠ¨é€‰æ‹©ç‰ˆæœ¬" class="headerlink" title="ğŸ æ‰‹åŠ¨é€‰æ‹©ç‰ˆæœ¬"></a>ğŸ æ‰‹åŠ¨é€‰æ‹©ç‰ˆæœ¬</h3><div class="img-container" data-caption="Semver è¯­ä¹‰åŒ–ç‰ˆæœ¬å·">![APXW0U.png](https://s2.ax1x.com/2019/03/12/APXW0U.png)</div><p><code>standard-version</code> éµå¾ª <a target="_blank" rel="noopener" href="https://semver.org/">Semver</a> è¯­ä¹‰åŒ–ç‰ˆæœ¬è§„èŒƒï¼Œå‡å¦‚ä½ ä¸Šæ¬¡ commit æ—¶é€‰æ‹©çš„æ˜¯ <code>fix</code>ï¼Œè¿™æ—¶é»˜è®¤åº”è¯¥æ›´æ–°çš„æ˜¯ä¸ª <code>path</code> ç‰ˆæœ¬ï¼Œå¦‚æœä½ æƒ³æ‰‹åŠ¨é€‰æ‹©ç‰ˆæœ¬ï¼Œå¯ä»¥è¿™æ ·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run release -- -r minor</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">standard-version -r 1.1.0</span><br></pre></td></tr></table></figure><h3 id="ğŸ€-é˜»æ­¢-Git-Hooks"><a href="#ğŸ€-é˜»æ­¢-Git-Hooks" class="headerlink" title="ğŸ€ é˜»æ­¢ Git Hooks"></a>ğŸ€ é˜»æ­¢ Git Hooks</h3><p>å½“ release åï¼Œç¨‹åºä¼šè‡ªåŠ¨å°†ä¿®æ”¹åçš„ <code>package.json</code> å’Œ <code>CHANGELOG.md</code> æ–‡ä»¶ commit æ‰ï¼Œæ‰€ä»¥å½“ä½¿ç”¨ <code>pre-commit</code> è¿™ç§é’©å­æ—¶å€™å¯èƒ½å°±ä¼šæŠ¥é”™ï¼Œå¯ä»¥é€šè¿‡ <code>--no-verify</code> è·³è¿‡æ£€æµ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run release -- --no-verify</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">standard-version -n</span><br></pre></td></tr></table></figure><h3 id="ğŸ”«-ç”Ÿå‘½å‘¨æœŸè„šæœ¬"><a href="#ğŸ”«-ç”Ÿå‘½å‘¨æœŸè„šæœ¬" class="headerlink" title="ğŸ”« ç”Ÿå‘½å‘¨æœŸè„šæœ¬"></a>ğŸ”« ç”Ÿå‘½å‘¨æœŸè„šæœ¬</h3><p><code>standard-version</code> æ”¯æŒä¸€äº›ç”Ÿå‘½å‘¨æœŸè„šæœ¬</p><ul><li><code>prerelease</code>: å‘å¸ƒä¹‹å‰</li><li><code>prebump / postbump</code>: ç‰ˆæœ¬å·æ›´æ–°ä¹‹å‰ &#x2F; ä¹‹å</li><li><code>prechangelog / postchangelog</code>: changelog ç”Ÿæˆä¹‹å‰ &#x2F; ä¹‹å</li><li><code>precommit / postcommit</code>: package.json å’Œ changelog æ–‡ä»¶æäº¤ä¹‹å‰ &#x2F; æäº¤ä¹‹å</li><li><code>pretag / posttag</code>: æ‰“ tag ä¹‹å‰ &#x2F; ä¹‹å</li></ul><p>å°±åƒè¿™æ ·ï¼Œä½ å¯ä»¥åœ¨æŸä¸ªå£°æ˜å‘¨æœŸä¸­å·æ‘¸åšç‚¹äº‹æƒ… ğŸ¤¡</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;standard-version&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;prebump&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo 9.9.9&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><code>changelog</code> ä¸­ issue åœ°å€é»˜è®¤æ˜¯ GitHub ä¸Šçš„ï¼Œå¦‚æœæƒ³ä¿®æ”¹æˆ <code>Jira</code> çš„åœ°å€ï¼Œå¯ä»¥é€šè¿‡ <code>postchangelog</code> é…åˆ <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/replace">replace</a> åº“æ¥ä¿®æ”¹å®ƒçš„é“¾æ¥åœ°å€</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;standard-version&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;postchangelog&quot;</span><span class="punctuation">:</span> <span class="string">&quot;replace &#x27;https://github.com/myproject/issues/&#x27; &#x27;https://myjira/browse/&#x27; CHANGELOG.md&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>ä½ ä¹Ÿå¯ä»¥è·³è¿‡æŸäº›ç”Ÿå‘½å‘¨æœŸ (<code>bump</code>, <code>changelog</code>, <code>commit</code>, <code>tag</code>) ï¼Œå‡å¦‚ä¸æƒ³å®ƒè‡ªåŠ¨æ‰“ <code>tag</code>ï¼Œä½ å¯ä»¥è¿™æ ·</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;standard-version&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;skip&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;tag&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ğŸ -Tag-å‰ç¼€"><a href="#ğŸ -Tag-å‰ç¼€" class="headerlink" title="ğŸ  Tag å‰ç¼€"></a>ğŸ  Tag å‰ç¼€</h3><p>é»˜è®¤æ‰“çš„ tag å‰ç¼€æ˜¯ vï¼Œç”Ÿæˆçš„ tag éƒ½æ˜¯ç±»ä¼¼ v1.0.0 è¿™ç§ï¼Œå¯ä»¥é€šè¿‡ <code>-t</code> è®¾ç½®å‰ç¼€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run release -- -t @scope/package\@</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">standard-version -t @scope/package\@</span><br></pre></td></tr></table></figure><p>ç”Ÿæˆçš„ tag çœ‹èµ·æ¥åƒè¿™æ · <code>@scope/package@2.0.0</code></p><h3 id="ğŸ˜Š-å¸®åŠ©"><a href="#ğŸ˜Š-å¸®åŠ©" class="headerlink" title="ğŸ˜Š å¸®åŠ©"></a>ğŸ˜Š å¸®åŠ©</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm run release -- -h</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">standard-version -h</span><br></pre></td></tr></table></figure><hr><h2 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h2><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åˆ©ç”¨ <code>husky</code> + <code>prettier</code> <code>eslint</code> <code>commitlint</code> <code>lint-staged</code> ç­‰å·¥å…·è¿›ä¸€æ­¥ä¼˜åŒ– git æµç¨‹ï¼Œåˆ©ç”¨ <code>husky</code> çš„ <code>pre-commit</code> é’©å­ï¼Œå¯ä»¥åœ¨ commit ä¹‹å‰å¤„ç†ä¸€äº›äº‹æƒ…ï¼Œå°±åƒ</p><ul><li><em>ä»£ç æ ¼å¼åŒ–</em></li><li><em>ä»£ç æ ¡éªŒ</em></li><li><em>Commit Message æ ¡éªŒ</em></li><li><em>â€¦</em></li></ul></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/70e342df.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/70e342df.html" itemprop="url">åˆ¤æ–­addEventListeneræ˜¯å¦æ”¯æŒpassiveå±æ€§</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2018-12-03 21:01:27" itemprop="dateCreated datePublished" datetime="2018-12-03T21:01:27+08:00">2018-12-03</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">3.2k</span></div></div></header><div class="post-body" itemprop="articleBody"><h2 id="å†™æ³•"><a href="#å†™æ³•" class="headerlink" title="å†™æ³•"></a>å†™æ³•</h2><p>å…ˆçœ‹ä¸€ä¸‹ MDN ç°åœ¨ <code>addEventListener</code> çš„å†™æ³•ï¼Œä¼ å‚å˜æˆäº†è¿™æ ·ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target.<span class="title function_">addEventListener</span>(type, listener, &#123; <span class="attr">capture</span>: <span class="title class_">Boolean</span>, <span class="attr">passive</span>: <span class="title class_">Boolean</span>, <span class="attr">once</span>: <span class="title class_">Boolean</span> &#125;)</span><br></pre></td></tr></table></figure><p>ä»¥å‰ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ª Boolean å€¼ï¼Œå®ƒå†³å®šæ˜¯å¦ä¸ºæ•è·æ¨¡å¼ï¼Œç°åœ¨å¯ä»¥ä¼ å…¥ä¸€ä¸ªå¯¹è±¡äº†</p><ul><li>capture: åŒä»¥å‰ä¸€æ ·ï¼Œè¡¨ç¤º listener æ˜¯åœ¨æ•è·é˜¶æ®µæ‰§è¡Œè¿˜æ˜¯å†’æ³¡é˜¶æ®µæ‰§è¡Œ</li><li>passive: è¡¨ç¤º listener æ°¸è¿œä¸ä¼šè°ƒç”¨ preventDefault()ã€‚</li><li>once: è¡¨ç¤º listener åªä¼šè°ƒç”¨ä¸€æ¬¡ã€‚</li></ul><h2 id="ç”¨å¤„"><a href="#ç”¨å¤„" class="headerlink" title="ç”¨å¤„"></a>ç”¨å¤„</h2><p>çœ‹ä¸Šå»æ‡µæ‡µçš„ï¼Œå…¶å®ï¼Œæ€»ç»“ä¸€ä¸‹å°±æ˜¯ <code>passive</code> ä¸»è¦æ˜¯ä¸ºäº†ä¼˜åŒ–æ»‘åŠ¨æ€§èƒ½è€Œç”Ÿï¼Œå½“ <code>passive</code> è®¾ç½®ä¸º <code>true</code> æ—¶ï¼Œä¼šå‘Šè¯‰æµè§ˆå™¨ä½ çš„ listener ä¸­ä¸ä¼šè°ƒç”¨ <code>preventDefault()</code> è¿™ä¸ªæ–¹æ³•ï¼Œä»è€Œæµè§ˆå™¨ä¼šåšä¸€ç³»åˆ—ä¼˜åŒ–æ¥æå‡æ»‘åŠ¨ä½“éªŒï¼Œä»è€Œä½¿æ»‘åŠ¨æ›´é¡ºç•…</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>å½“ä½ çš„ listener ä¸­ä¸ä¼šè°ƒç”¨ <code>preventDefault()</code> æ–¹æ³•æ—¶ï¼Œéƒ½å°½é‡ä½¿ç”¨å®ƒï¼Œå¦‚æœä½ è®¾ç½®äº† <code>passive</code> ä¸º <code>true</code> å¹¶ä¸”ä½ ä»£ç ä¸­è¿˜è°ƒç”¨äº† <code>preventDefault()</code> æ–¹æ³•ï¼Œé‚£ä¹ˆæµè§ˆå™¨ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯</p><h2 id="å…¼å®¹æ€§"><a href="#å…¼å®¹æ€§" class="headerlink" title="å…¼å®¹æ€§"></a>å…¼å®¹æ€§</h2><p>è¿™ä¸ªå±æ€§å‡ºæ¥çš„æ¯”è¾ƒæ™šï¼Œå…¼å®¹æ€§ä¸å¤ªå¥½ï¼Œæ€ä¹ˆæ£€æµ‹æµè§ˆå™¨æ˜¯å¦æ”¯æŒè¯¥å±æ€§å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸ªæ–¹æ³•</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> passiveSupported = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> options = <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(&#123;&#125;, <span class="string">&#x27;passive&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">get</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      passiveSupported = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;test&#x27;</span>, <span class="literal">null</span>, options)</span><br><span class="line">&#125; <span class="keyword">catch</span> (err) &#123;&#125;</span><br></pre></td></tr></table></figure><p>å½“æµè§ˆå™¨æ”¯æŒè¯¥å±æ€§æ—¶ <code>passiveSupported</code> ä¼šè¢«èµ‹å€¼ä¸º <code>true</code>ï¼Œè¿™æ®µä»£ç ç®€ç›´æ˜¯é…·åˆ°æ²¡æœ‹å‹ ğŸ‘½</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/73bc7195.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/73bc7195.html" itemprop="url">å¦‚ä½•æ¨¡æ‹Ÿç§»åŠ¨ç«¯è§¦æ‘¸äº‹ä»¶</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2018-11-20 13:45:48" itemprop="dateCreated datePublished" datetime="2018-11-20T13:45:48+08:00">2018-11-20</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">26k</span></div></div></header><div class="post-body" itemprop="articleBody"><p>åœ¨ pc ç«¯æ¨¡æ‹Ÿç§»åŠ¨ç«¯ touch äº‹ä»¶ï¼Œä»£ç æ¥è‡ª Vant</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ¨¡æ‹Ÿç§»åŠ¨ç«¯ touch äº‹ä»¶</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> eventTarget</span><br><span class="line"></span><br><span class="line"><span class="comment">// polyfills</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable language_">document</span>.<span class="property">createTouch</span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">createTouch</span> = <span class="keyword">function</span>(<span class="params">view, target, identifier, pageX, pageY, screenX, screenY</span>) &#123;</span><br><span class="line">    <span class="comment">// auto set</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Touch</span>(</span><br><span class="line">      target,</span><br><span class="line">      identifier,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">pageX</span>: pageX,</span><br><span class="line">        <span class="attr">pageY</span>: pageY,</span><br><span class="line">        <span class="attr">screenX</span>: screenX,</span><br><span class="line">        <span class="attr">screenY</span>: screenY,</span><br><span class="line">        <span class="attr">clientX</span>: pageX - <span class="variable language_">window</span>.<span class="property">pageXOffset</span>,</span><br><span class="line">        <span class="attr">clientY</span>: pageY - <span class="variable language_">window</span>.<span class="property">pageYOffset</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">0</span></span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable language_">document</span>.<span class="property">createTouchList</span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">createTouchList</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> touchList = <span class="title class_">TouchList</span>()</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="variable language_">arguments</span>.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      touchList[i] = <span class="variable language_">arguments</span>[i]</span><br><span class="line">    &#125;</span><br><span class="line">    touchList.<span class="property">length</span> = <span class="variable language_">arguments</span>.<span class="property">length</span></span><br><span class="line">    <span class="keyword">return</span> touchList</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * create an touch point</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@constructor</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">target</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">identifier</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">pos</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">deltaX</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">deltaY</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Object</span>&#125; <span class="variable">touchPoint</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">Touch</span> = <span class="keyword">function</span> <span class="title function_">Touch</span>(<span class="params">target, identifier, pos, deltaX, deltaY</span>) &#123;</span><br><span class="line">  deltaX = deltaX || <span class="number">0</span></span><br><span class="line">  deltaY = deltaY || <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">identifier</span> = identifier</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">target</span> = target</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">clientX</span> = pos.<span class="property">clientX</span> + deltaX</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">clientY</span> = pos.<span class="property">clientY</span> + deltaY</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">screenX</span> = pos.<span class="property">screenX</span> + deltaX</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">screenY</span> = pos.<span class="property">screenY</span> + deltaY</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">pageX</span> = pos.<span class="property">pageX</span> + deltaX</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">pageY</span> = pos.<span class="property">pageY</span> + deltaY</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * create empty touchlist with the methods</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@constructor</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> <span class="variable">touchList</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TouchList</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> touchList = []</span><br><span class="line"></span><br><span class="line">  touchList[<span class="string">&#x27;item&#x27;</span>] = <span class="keyword">function</span>(<span class="params">index</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>[index] || <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// specified by Mozilla</span></span><br><span class="line">  touchList[<span class="string">&#x27;identifiedTouch&#x27;</span>] = <span class="keyword">function</span>(<span class="params">id</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>[id + <span class="number">1</span>] || <span class="literal">null</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> touchList</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Simple trick to fake touch event support</span></span><br><span class="line"><span class="comment"> * this is enough for most libraries like Modernizr and Hammer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fakeTouchSupport</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> objs = [<span class="variable language_">window</span>, <span class="variable language_">document</span>.<span class="property">documentElement</span>]</span><br><span class="line">  <span class="keyword">var</span> props = [<span class="string">&#x27;ontouchstart&#x27;</span>, <span class="string">&#x27;ontouchmove&#x27;</span>, <span class="string">&#x27;ontouchcancel&#x27;</span>, <span class="string">&#x27;ontouchend&#x27;</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> o = <span class="number">0</span>; o &lt; objs.<span class="property">length</span>; o++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> p = <span class="number">0</span>; p &lt; props.<span class="property">length</span>; p++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (objs[o] &amp;&amp; objs[o][props[p]] === <span class="literal">undefined</span>) &#123;</span><br><span class="line">        objs[o][props[p]] = <span class="literal">null</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * only trigger touches when the left mousebutton has been pressed</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">touchType</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">Function</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onMouse</span>(<span class="params">touchType</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">ev</span>) &#123;</span><br><span class="line">    <span class="comment">// prevent mouse events</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ev.<span class="property">which</span> !== <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// The EventTarget on which the touch point started when it was first placed on the surface,</span></span><br><span class="line">    <span class="comment">// even if the touch point has since moved outside the interactive area of that element.</span></span><br><span class="line">    <span class="comment">// also, when the target doesnt exist anymore, we update it</span></span><br><span class="line">    <span class="keyword">if</span> (ev.<span class="property">type</span> === <span class="string">&#x27;mousedown&#x27;</span> || !eventTarget || (eventTarget &amp;&amp; !eventTarget.<span class="property">dispatchEvent</span>)) &#123;</span><br><span class="line">      eventTarget = ev.<span class="property">target</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">triggerTouch</span>(touchType, ev)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// reset</span></span><br><span class="line">    <span class="keyword">if</span> (ev.<span class="property">type</span> === <span class="string">&#x27;mouseup&#x27;</span>) &#123;</span><br><span class="line">      eventTarget = <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * trigger a touch event</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">eventName</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">mouseEv</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">triggerTouch</span>(<span class="params">eventName, mouseEv</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> touchEvent = <span class="variable language_">document</span>.<span class="title function_">createEvent</span>(<span class="string">&#x27;Event&#x27;</span>)</span><br><span class="line">  touchEvent.<span class="title function_">initEvent</span>(eventName, <span class="literal">true</span>, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">  touchEvent.<span class="property">altKey</span> = mouseEv.<span class="property">altKey</span></span><br><span class="line">  touchEvent.<span class="property">ctrlKey</span> = mouseEv.<span class="property">ctrlKey</span></span><br><span class="line">  touchEvent.<span class="property">metaKey</span> = mouseEv.<span class="property">metaKey</span></span><br><span class="line">  touchEvent.<span class="property">shiftKey</span> = mouseEv.<span class="property">shiftKey</span></span><br><span class="line"></span><br><span class="line">  touchEvent.<span class="property">touches</span> = <span class="title function_">getActiveTouches</span>(mouseEv)</span><br><span class="line">  touchEvent.<span class="property">targetTouches</span> = <span class="title function_">getActiveTouches</span>(mouseEv)</span><br><span class="line">  touchEvent.<span class="property">changedTouches</span> = <span class="title function_">createTouchList</span>(mouseEv)</span><br><span class="line"></span><br><span class="line">  eventTarget.<span class="title function_">dispatchEvent</span>(touchEvent)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * create a touchList based on the mouse event</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">mouseEv</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">TouchList</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createTouchList</span>(<span class="params">mouseEv</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> touchList = <span class="title class_">TouchList</span>()</span><br><span class="line">  touchList.<span class="title function_">push</span>(<span class="keyword">new</span> <span class="title class_">Touch</span>(eventTarget, <span class="number">1</span>, mouseEv, <span class="number">0</span>, <span class="number">0</span>))</span><br><span class="line">  <span class="keyword">return</span> touchList</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * receive all active touches</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">mouseEv</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> &#123;<span class="type">TouchList</span>&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getActiveTouches</span>(<span class="params">mouseEv</span>) &#123;</span><br><span class="line">  <span class="comment">// empty list</span></span><br><span class="line">  <span class="keyword">if</span> (mouseEv.<span class="property">type</span> === <span class="string">&#x27;mouseup&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">TouchList</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">createTouchList</span>(mouseEv)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * TouchEmulator initializer</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TouchEmulator</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">fakeTouchSupport</span>()</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, <span class="title function_">onMouse</span>(<span class="string">&#x27;touchstart&#x27;</span>), <span class="literal">true</span>)</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, <span class="title function_">onMouse</span>(<span class="string">&#x27;touchmove&#x27;</span>), <span class="literal">true</span>)</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, <span class="title function_">onMouse</span>(<span class="string">&#x27;touchend&#x27;</span>), <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// start distance when entering the multitouch mode</span></span><br><span class="line"><span class="title class_">TouchEmulator</span>[<span class="string">&#x27;multiTouchOffset&#x27;</span>] = <span class="number">75</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">TouchEmulator</span>()</span><br></pre></td></tr></table></figure><p>ç›´æ¥å¼•å…¥è¯¥æ–‡ä»¶ï¼Œpc ç«¯å°±å¯ä»¥å“åº”ç§»åŠ¨ç«¯çš„ <code>touchstart</code>ã€<code>touchmove</code>ã€<code>touchend</code> äº‹ä»¶äº† âœ¨ã€‚</p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://xiaojun1994.top/posts/d87f7e0c.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="xiaojun1994"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Xiaojun's Blog"></span><header class="post-header"><h2 class="post-title" itemprop="name headline"> <a class="post-title-link" href="/posts/d87f7e0c.html" itemprop="url">å°æŠ€å·§å¤„ç†fixedå®šä½åå…¶å®ƒå†…å®¹è¢«è¦†ç›–çš„é—®é¢˜</a></h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="Created: 2018-11-04 17:51:20" itemprop="dateCreated datePublished" datetime="2018-11-04T17:51:20+08:00">2018-11-04</time></span><div class="post-symbolscount"> <span class="post-meta-divider">|</span><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i></span> <span class="post-meta-item-text">å­—æ•°:</span> <span title="å­—æ•°">16k</span></div></div></header><div class="post-body" itemprop="articleBody"><p>æˆ‘ä»¬çŸ¥é“å½“å¯¹ä¸€ä¸ªå…ƒç´ è®¾ç½®äº† <code>position: fixed;</code> åï¼Œè¯¥å…ƒç´ ä¼šè„±ç¦»æ–‡æ¡£æµï¼Œä¸‹é¢çš„å†…å®¹ä¼šé¡¶ä¸Šæ¥ï¼Œå¯¼è‡´è¢«å†…å®¹è¢«é®ç›–ã€‚å¸¸è§çš„ä¸€ä¸ªåšæ³•æ˜¯è®¾ç½®ä¸‹é¢å†…å®¹çš„ <code>padding</code> æˆ– <code>margin</code>ï¼Œè™½ç„¶èƒ½è¾¾åˆ°æ•ˆæœï¼Œä½†æ˜¯æ€»å½’ä¸å®Œç¾ï¼Œç‰¹åˆ«æ˜¯å½“æˆ‘ä»¬æƒ³å°è£…ä¸€ä¸ªç»„ä»¶ç»™åˆ«äººç”¨çš„æ—¶å€™ï¼Œè¿˜å¾—è®©åˆ«äººè®¾ç½®ä¸€ä¸‹æ ·å¼ï¼Œè¿™æ ·å²‚ä¸éº»çƒ¦ï¼Œæ‰€ä»¥å°±æœ‰äº†ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼Œä»¥æˆ‘å°è£…çš„è¿™ä¸ª <code>vue</code> <code>header</code> ç»„ä»¶ä¸ºä¾‹</p><h3 id="ç¤ºä¾‹ä»£ç "><a href="#ç¤ºä¾‹ä»£ç " class="headerlink" title="ç¤ºä¾‹ä»£ç "></a>ç¤ºä¾‹ä»£ç </h3><h4 id="template"><a href="#template" class="headerlink" title="template"></a>template</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:class</span>=<span class="string">&quot;classList&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;i-nav-bar__inner&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;i-nav-bar__left&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleClickLeft&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;left&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&quot;i-nav-bar__arrow fa fa-fw fa-angle-left&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;leftArrow&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;i-nav-bar__text&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;leftText&quot;</span>&gt;</span>&#123;&#123; leftText &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;i-nav-bar__title&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;title&quot;</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;i-nav-bar__right&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleClickRight&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">&quot;right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="script"><a href="#script" class="headerlink" title="script"></a>script</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;INavBar&#x27;</span>,</span><br><span class="line">  <span class="attr">props</span>: &#123;</span><br><span class="line">    <span class="attr">title</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">leftArrow</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">    <span class="attr">leftText</span>: <span class="title class_">String</span>,</span><br><span class="line">    <span class="attr">fixed</span>: <span class="title class_">Boolean</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">computed</span>: &#123;</span><br><span class="line">    <span class="title function_">classList</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> [</span><br><span class="line">        <span class="string">&#x27;i-nav-bar&#x27;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&#x27;i-nav-bar--fixed&#x27;</span>: <span class="variable language_">this</span>.<span class="property">fixed</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handleClickLeft</span>(<span class="params">ev</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;click-left&#x27;</span>, ev)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">handleClickRight</span>(<span class="params">ev</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.$emit(<span class="string">&#x27;click-right&#x27;</span>, ev)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="style-scss"><a href="#style-scss" class="headerlink" title="style(scss)"></a>style(scss)</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$height</span>: <span class="number">50px</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.i-nav-bar</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="variable">$height</span>;</span><br><span class="line">  &amp;__inner &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">1px</span> rgba(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.07</span>);</span><br><span class="line">    <span class="attribute">height</span>: <span class="variable">$height</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#4a4d5a</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;__left &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    &amp;<span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">0.5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.i-nav-bar__arrow</span> &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">25px</span>;</span><br><span class="line">      <span class="attribute">margin-top</span>: -<span class="number">1px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="selector-class">.i-nav-bar__text</span> &#123;</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">      <span class="attribute">margin-left</span>: -<span class="number">6px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;__title &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#34495e</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;__right &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    &amp;<span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">0.5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;<span class="attr">--fixed</span> &#123;</span><br><span class="line">    <span class="selector-class">.i-nav-bar__inner</span> &#123;</span><br><span class="line">      <span class="attribute">position</span>: fixed;</span><br><span class="line">      <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>å¤–é¢å¥—ä¸€ä¸ªçˆ¶å…ƒç´ ï¼Œ<code>height</code> å‡è®¾ä¸º 50pxï¼Œç„¶åæˆ‘ä»¬å¯¹é‡Œé¢è¿™ä¸ªå…ƒç´ è®¾ç½® <code>position: fixed;</code>ï¼Œå®ƒçš„ <code>height</code> ä¹Ÿè®¾ç½® 50pxï¼Œè¿™æ ·çš„è¯è™½ç„¶é‡Œé¢è„±ç¦»äº†æ–‡æ¡£æµï¼Œä½†æ˜¯çˆ¶å…ƒç´ ä¾ç„¶å æ®ç€ç©ºé—´ï¼Œæ‰€ä»¥ä¸‹é¢çš„å…ƒç´ ä¹Ÿå°±ä¸ä¼šé¡¶ä¸Šæ¥ï¼Œå½“åˆ«äººä½¿ç”¨ä½ çš„ç»„ä»¶æ—¶å†ä¹Ÿä¸ç”¨è´¹åŠ›è®¾ç½® <code>padding</code> æˆ– <code>margin</code> äº†ã€‚</p><h3 id="ä¸€äº›æ•ˆæœæˆªå›¾"><a href="#ä¸€äº›æ•ˆæœæˆªå›¾" class="headerlink" title="ä¸€äº›æ•ˆæœæˆªå›¾"></a>ä¸€äº›æ•ˆæœæˆªå›¾</h3><p>å›¾ä¸­å¤´éƒ¨æ˜¯ä¸Šé¢ç¤ºä¾‹ä»£ç çš„æ•ˆæœå›¾ï¼Œtabbar æ˜¯æˆ‘å°è£…çš„å¦ä¸€ä¸ªç»„ä»¶ï¼Œè¿™é‡Œä¸ºäº†æ¼”ç¤ºæ•ˆæœï¼Œæˆ‘æŠŠä»–ä»¬æ”¾åˆ°ä¸€èµ·</p><p><img src="https://s2.ax1x.com/2019/05/24/VFWSE9.png" alt="5mWmzX.png"></p></div><footer class="post-footer"><div class="post-eof"></div></footer></div></article></section><nav class="pagination"> <a class="extend prev" rel="prev" href="/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot; aria-label&#x3D;&quot;Previous page&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot; aria-label&#x3D;&quot;Next page&quot;&gt;&lt;&#x2F;i&gt;</a></nav></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div id="sidebar-dimmer"></div><div class="sidebar-inner"><section class="site-overview-wrap sidebar-panel sidebar-panel-active"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="xiaojun1994"><p class="site-author-name" itemprop="name">xiaojun1994</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/%20%7C%7C%20archive"><span class="site-state-item-count">28</span> <span class="site-state-item-name">posts</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">20</span> <span class="site-state-item-name">tags</span></a></div></nav><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/xiaojun1994" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i> GitHub</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-heartbeat"></i> å‹é“¾</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"> <a href="http://laibh.top/" title="èµ–åŒå­¦" target="_blank">èµ–åŒå­¦</a></li><li class="links-of-blogroll-item"> <a href="http://xzzdll.cn/" title="John Stark" target="_blank">John Stark</a></li><li class="links-of-blogroll-item"> <a href="http://www.huyujs.com/" title="èƒ¡é›¨" target="_blank">èƒ¡é›¨</a></li><li class="links-of-blogroll-item"> <a href="https://www.mghio.cn/" title="mghio" target="_blank">mghio</a></li></ul></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span><span class="with-love" id="animate"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">xiaojun1994</span></div><div class="busuanzi-count"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="site-uv" title="Total Visitors"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span><span class="site-pv" title="Total Views"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/js/src/utils.js?v=6.4.1"></script><script type="text/javascript" src="/js/src/motion.js?v=6.4.1"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.1"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({model:{jsonPath:"/live2dw/assets/tororo.model.json"},display:{position:"left",hOffset:0,vOffset:0,width:250,height:250},mobile:{show:!1},log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html>